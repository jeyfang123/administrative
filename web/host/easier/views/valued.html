<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <title>北京市朝阳区行政服务中心--认证</title>
    <meta name="keywords" content="行政服务">
    <meta name="description" content="朝阳">
    <link href="/hadmin/css/bootstrap.min.css" rel="stylesheet">
    <link href="/hadmin/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="/hadmin/css/animate.css" rel="stylesheet">
    <link href="/hadmin/css/style.css" rel="stylesheet">
    <!-- Sweet Alert -->
    <link href="/hadmin/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <link rel="stylesheet" href="/easier/css/header.css">
    <link rel="stylesheet" href="/easier/css/footer.css">
    <link rel="stylesheet" href="/easier/css/valued.css">
    <script>
        if (window.top !== window.self) {
            window.top.location = window.location;
        }
    </script>

</head>

<body class="gray-bg">
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-12">
        <div class="col-sm-4">
            <div class="">
                <img class="col-sm-8 pull-right" src="/easier/img/logo.png" alt="">
            </div>
        </div>
        <div class="col-sm-6">
            <div class="input-group col-sm-7 search-area pull-right">
                <input type="text" placeholder="请输入服务项目名称" class="input-sm-7 form-control">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-sm btn-primary"> 搜索</button>
                </span>
            </div>
        </div>
    </div>
</div>
<div class="wrapper wrapper-content wrapper-nav">
    <div class="row">
        <div class="col-sm-12 col-sm-content ">
            <div class="body-content col-sm-9 white-bg">
                <div class="text-center valued-title">身份实名认证</div>
                <div class="valued-content">
                    <div class="tabs-container">
                        <ul class="nav nav-tabs">
                            <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true"> 个人认证</a>
                            </li>
                            <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false"> 法人认证 </a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div id="tab-1" class="tab-pane active">
                                <div class="panel-body">
                                    <form class="form-horizontal form-per">
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">手机号</label>
                                            <div class="col-sm-5">
                                                <input type="text" maxlength="11" name="phone" class="phone form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">图片验证码</label>
                                            <div class="col-sm-5">
                                                <input type="text" maxlength="4" name="verify" class="verify form-control required">
                                                <img class="verify-code-img" src="/easier/user/verifyCode" alt="">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">短信验证码</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="4" name="code" class="code form-control required" name="password">
                                                <button class="btn getcode">获取短信验证码</button>
                                                <div class="sms-info"></div>
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">个人姓名</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="15" name="compellation" class="compellation form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">身份证号码</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="18" name="id" class="id form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="col-sm-5 col-md-offset-4">
                                            <button class="btn btn-success btn-block per-value">认证</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div id="tab-2" class="tab-pane">
                                <div class="panel-body">
                                    <form class="form-horizontal form-enter">
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">手机号</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="11" name="phone" class="phone form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">图片验证码</label>
                                            <div class="col-sm-5">
                                                <input type="text" maxlength="4" name="verify" class="verify form-control required">
                                                <img class="verify-code-img" src="/easier/user/verifyCode" alt="">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">短信验证码</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="4" name="code" class="code form-control required" name="password">
                                                <button class="btn getcode">获取短信验证码</button>
                                                <div class="sms-info"></div>
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">个人姓名</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="10" name="artificial" class="artificial form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">企业全称</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="50" name="enterprise" class="enterprise form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 col-md-offset-2 control-label">统一社会信用代码</label>

                                            <div class="col-sm-5">
                                                <input type="text" maxlength="18" name="creditcode" class="creditcode form-control required">
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="col-sm-5 col-md-offset-4">
                                            <button class="btn btn-success btn-block enter-value">认证</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="col-sm-12" style="text-align: center;background-color: #E7E7E7;padding-top: 35px;padding-bottom: 50px;">
    <div class="foot-main">
        <div class="foot-link">
            <a href="javascript:void(0)" style="line-height:20px;">把本站设为首页</a>
            <span style=" padding-left:12px; padding-right:12px;">|</span>
            <a href="javascript:void(0)">关于北京市朝阳区政务服务网</a>
            <span style=" padding-left:12px; padding-right:12px;">|</span>
            <a href="javascript:void(0)">本站申明</a>
            <span style=" padding-left:12px; padding-right:12px;">|</span>
            <a href="javascript:void(0)">新手指南</a>
            <span style=" padding-left:12px; padding-right:12px;">|</span>
            <a href="javascript:void(0)" target="_blank">联系我们</a>
        </div>
        <div class="foot-phone">
            <img src="/easier/img/phone.png">
        </div>
        <div class="foot-copyright">
            <span style=" padding-right:15px; font-size:13px; line-height:24px; color:#666;">主办单位：北京市人民政府办公厅</span>
            <span style=" padding-right:15px; font-size:13px; line-height:24px; color:#666;">备案：京ICP备123456789号-2</span>
            <span style=" padding-right:15px; font-size:13px; line-height:24px; color:#666;">
		 		            <a href="javascript:void(0)" style="display:inline-block;text-decoration:none;line-height:24px;">
                                <img src="/easier/img/batb.png" style="float:left;">
                                <span style="font-size:13px;margin: 0px 0px 0px 5px;color:#666;">冀公网安备 12346579887465号</span>
                            </a>
		 	            </span>
            <br>
            <span style=" font-size:13px; line-height:24px; color:#666;">中文域名：北京朝阳.政务</span>
            <span style=" font-size:13px; line-height:24px; color:#666;">建议使用1366*768分辨率/IE9.0或以上浏览器访问达到最佳效果</span>
            <div class="foot-political"><a href="javascript:void(0)" target="_blank"><img src="/easier/img/political-logo.png" width="50" height="62"></a></div>
        </div>
    </div>
</div>
</body>
<!-- 全局js -->
<script src="/hadmin/js/jquery.min.js?v=2.1.4"></script>
<script src="/hadmin/js/bootstrap.min.js?v=3.3.6"></script>
<!-- Sweet alert -->
<script src="/hadmin/js/plugins/sweetalert/sweetalert.min.js"></script>
<!-- Jquery Validate -->
<script src="/hadmin/js/plugins/validate/jquery.validate.min.js"></script>
<script src="/hadmin/js/plugins/validate/messages_zh.min.js"></script>
<script src="/plugins/bower_components/cookie/jquery.cookie.min.js"></script>
<script src="/plugins/bower_components/md5/md5.js" type="text/javascript"></script>
<script src="/public/js/public.js"></script>
<script src="/easier/js/model.js"></script>
<script>
    $(function () {
        var storage = window.localStorage;
        var perInter = '';
        var enterInter = '';

        function JqValidatePer() {
            return $('.form-per').validate({
                rules:{
                    phone:{
                        required: true,
                        minlength: 11,
                        maxlength:11,
                    },
                    verify:{
                        required: true,
                        minlength: 4,
                        maxlength:4
                    },
                    code:{
                        required: true,
                        minlength: 4,
                        maxlength:4
                    },
                    compellation:{
                        required: true,
                        minlength: 2
                    },
                    id:{
                        required: true,
                        minlength: 18,
                        maxlength:18
                    },
                },
                messages:{
                    phone:{
                        required:  "请输入您的手机号",
                        minlength: "请输入正确的手机号",
                        maxlength: "请输入正确的手机号"
                    },
                    verify:{
                        required: "请输入验证码",
                        minlength: "请输入正确的验证码",
                        maxlength: "请输入正确的验证码"
                    },
                    code:{
                        required: "请输入验证码",
                        minlength: "请输入正确的验证码",
                        maxlength: "请输入正确的验证码"
                    },
                    compellation:{
                        required: "请输入姓名",
                        minlength: "请输入正确的姓名",
                    },
                    id:{
                        required: "请输入身份证号",
                        minlength: "请输入正确的身份证号",
                    }
                }
            });
        }
        function JqValidateEnter() {
            return $('.form-enter').validate({
                rules:{
                    phone:{
                        required: true,
                        minlength: 11,
                        maxlength:11,
                    },
                    verify:{
                        required: true,
                        minlength: 4,
                        maxlength:4
                    },
                    code:{
                        required: true,
                        minlength: 4,
                        maxlength:4
                    },
                    artificial:{
                        required: true,
                        minlength: 2
                    },
                    enterprise:{
                        required: true,
                        minlength: 2
                    },
                    creditcode:{
                        required: true,
                        minlength: 18,
                        maxlength:18
                    },
                },
                messages:{
                    phone:{
                        required:  "请输入您的手机号",
                        minlength: "手机号错误",
                        maxlength: "手机号错误"
                    },
                    verify:{
                        required: "请输入验证码",
                        minlength: "验证码错误",
                        maxlength: "验证码错误"
                    },
                    code:{
                        required: "请输入验证码",
                        minlength: "验证码错误",
                        maxlength: "验证码错误"
                    },
                    artificial:{
                        required: "请输入姓名",
                        minlength: "请输入姓名",
                    },
                    enterprise:{
                        required: "请输入公司全称",
                        minlength: "请输入正确的公司名称",
                    },
                    creditcode:{
                        required: "请输入统一社会信用代码",
                        minlength: "输入错误",
                        maxlength: "输入错误"
                    }
                }
            });
        }
        
        $('.getcode').click(function (event) {
            event.preventDefault();
            var form = $(this).parents('form');
            var verify = form.find('.verify').val();
            var phone = form.find('.phone').val();
            if(verify == ''){
                swal({
                    title: "警告！",
                    text: '请填写图片验证码'
                });
            }
            else if(phone == ''){
                swal({
                    title: "错误！",
                    text: '手机号码填写错误'
                });
            }
            else{
                Model.checkVerifyCode({
                    'verify':verify
                },function (res) {
                    if(res.code != CODE_SUCCESS){
                        swal({
                            title: "错误！",
                            text: '图片验证码填写错误'
                        });
                    }
                    else{
                        sendCode(phone,form);
                    }
                })
            }
        })

        function sendCode(phone,form) {
            Model.sendCode({
                'phone':phone
            },function (res) {
                if(res.code != CODE_SUCCESS){
                    swal({
                        title: "错误！",
                        text: res.msg
                    });
                }
                else{
                    swal({
                        title: "Success",
                        text: '发送成功',
                        type:'success'
                    });
                    preventSend(form);
                }
            },{},{});
        }

        $('button.per-value').click(function (event) {
            var form = $(this).parents('form');
            form.find('.error-msg').hide();
            var phone = $.trim(form.find('.phone').val());
            var code = ($.trim(form.find('.code').val()));
            var compellation = ($.trim(form.find('.compellation').val()));
            var id = ($.trim(form.find('.id').val()));
            if(JqValidatePer().form()){
                event.preventDefault();
                Model.perValue({
                    'access':$.cookie('access'),
                    'phone':phone,
                    'code':code,
                    'compellation':compellation,
                    'id':id
                },function (res) {
                    if(res.code != CODE_SUCCESS){
                        swal({
                            title: "错误！",
                            text: res.msg
                        })
                    }
                    else{
                        swal({
                            title: "Success！",
                            text: '认证成功',
                            type:'success'
                        });
                        var from = storage.getItem('from');
                        if(from != null){
                            storage.removeItem('from');
                            window.location.href = from;
                        }
                        else{
                            window.location.href = '/easier/index';
                        }
                    }
                })
            }
        });

        $('button.enter-value').click(function (event) {
            var form = $(this).parents('form');
            form.find('.error-msg').hide();
            var phone = $.trim(form.find('.phone').val());
            var code = ($.trim(form.find('.code').val()));
            var artificial = ($.trim(form.find('.artificial').val()));
            var enterprise = ($.trim(form.find('.enterprise').val()));
            var creditcode = ($.trim(form.find('.creditcode').val()));
            if(JqValidateEnter().form()){
                event.preventDefault();
                Model.enterValue({
                    'access':$.cookie('access'),
                    'phone':phone,
                    'code':code,
                    'artificial':artificial,
                    'enterprise':enterprise,
                    'creditcode':creditcode,
                },function (res) {
                    if(res.code != CODE_SUCCESS){
                        swal({
                            title: "错误！",
                            text: res.msg
                        })
                    }
                    else{
                        swal({
                            title: "Success！",
                            text: '认证成功',
                            type:'success'
                        });
                        var from = storage.getItem('from');
                        if(from != null){
                            storage.removeItem('from');
                            window.location.href = from;
                        }
                        else{
                            window.location.href = '/easier/index';
                        }
                    }
                })
            }
        });

        function preventSend(form) {
            form.find('.getcode').attr('disabled','true');
            var label = '<label class="prevent-msg">还有<span class="remain-sec">60</span>秒可重新获取</label>';
            form.find('.sms-info').html(label);
            var sec = 60;
            perInter = setInterval(function () {
                sec = sec - 1;
                if(sec == 0){
                    form.find('.getcode').removeAttr('disabled');
                    form.find('.prevent-msg').remove();
                    clearInterval(perInter);
                }
                else{
                    form.find('.remain-sec').text(sec);
                }
            },1000)
        }

        
    })
</script>

</html>
