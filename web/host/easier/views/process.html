<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>北京市朝阳区行政服务中心</title>
    <meta name="keywords" content="行政服务">
    <meta name="description" content="朝阳">

    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/hadmin/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="/hadmin/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <!-- Sweet Alert -->
    <link href="/hadmin/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <link href="/hadmin/css/animate.css" rel="stylesheet">
    <link href="/hadmin/css/style.css?v=4.1.0" rel="stylesheet">
    <link href="/easier/css/process.css" rel="stylesheet">
    <link rel="stylesheet" href="/easier/css/header.css">
    <link rel="stylesheet" href="/easier/css/footer.css">
</head>
<body class="gray-bg">
    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-sm-12">
            <div class="col-sm-4">
                <a href="/easier/index">
                    <img class="col-sm-8 pull-right" src="/easier/img/logo.png" alt="">
                </a>
            </div>
            <div class="col-sm-6">
                <div class="input-group col-sm-7 search-area pull-right">
                    <input type="text" placeholder="请输入服务项目名称" class="input-sm-7 form-control">
                    <span class="input-group-btn">
                            <button type="button" class="btn btn-sm btn-primary"> 搜索</button>
                        </span>
                </div>
            </div>
            <div class="col-sm-2">
                <div class="user-center-area">
                    <a class="user-center-href" href="javascript:;"><i style="font-size: 20px;margin-right: 5px;" class="fa fa-user"></i>用户中心</a>
                    <div class="user-info">
                        <!--<a href="javascript:;">注册</a> / <a href="javascript:;">登录</a>-->
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12 nav-area">
            <div class="nav-bar">
                <div class="nav-item"><span><a href="/easier/index">首页</a></span></div>
                <div class="nav-item"><span><a href="/easier/process/index?type=person">个人办事</a></span></div>
                <div class="nav-item"><span><a href="/easier/process/index?type=enter">法人办事</a></span></div>
                <div class="nav-item"><span><a href="/easier/process/index?type=exam">行政审批</a></span></div>
                <div class="nav-item"><span>阳光政务</span></div>
                <div class="nav-item"><span>今日关注</span></div>
                <div class="nav-item"><span>政策解读</span></div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 location-page">
        <span>当前位置：</span><span class="location-page-span"></span>
    </div>
    <div class="wrapper wrapper-content wrapper-nav">
    <div class="row">
        <div class="col-sm-12 col-sm-content">
            <div class="col-sm-4" style="">
                <div class="body-left pull-right">
                    <div class="body-left-tit">
                        <div class="left-tit-sub pointer">按部门</div>
                        <div class="left-tit-sub" style="right: 2px;">按主题</div>
                    </div>
                    <div class="body-left-con">
                        <div class="left-sub">
                            {% for item in data.department %}
                            <div class="depart-item" data-id="{{ item.role_id }}">{{ item.rolename }}</div>
                            {% endfor %}
                        </div>
                        <div class="left-sub" style="display: none">
                            {% for item in data.proType %}
                            <div class="depart-item" data-id="{{ item.type_id }}">{{ item.type_name }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="input-group col-sm-4" style="margin-bottom: 7px;">
                    <input type="text" id="keyword" placeholder="请输入关键字" class="input form-control">
                    <span class="input-group-btn">
                        <button type="button" id="search" class="btn search-btn"> <i class="fa fa-search"></i> 搜索</button>
                    </span>
                </div>
                <div class="body-right">
                    <div class="right-heat">
                        <span class="right-heat-tit">热点服务</span>
                        <div class="right-heat-bottom"></div>
                    </div>
                    <div class="right-heat-list">
                        <!--<div class="process-list">-->
                            <!--<div class="li-circle"></div>-->
                            <!--<span class="process-title" >事业单位法人注销登记</span>-->
                            <!--<div class="process-heat">-->
                                <!--<img src="/easier/img/2.png" alt="">-->
                            <!--</div>-->
                        <!--</div>-->
                    </div>
                    <div id="processpage" class="js-pages">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12" style="text-align: center;background-color: #E7E7E7;padding-top: 35px;padding-bottom: 50px;">
            <div class="foot-main">
                <div class="foot-link">
                    <a href="javascript:void(0)" style="line-height:20px;">把本站设为首页</a>
                    <span style=" padding-left:12px; padding-right:12px;">|</span>
                    <a href="javascript:void(0)">关于北京市朝阳区政务服务网</a>
                    <span style=" padding-left:12px; padding-right:12px;">|</span>
                    <a href="javascript:void(0)">本站申明</a>
                    <span style=" padding-left:12px; padding-right:12px;">|</span>
                    <a href="javascript:void(0)">新手指南</a>
                    <span style=" padding-left:12px; padding-right:12px;">|</span>
                    <a href="javascript:void(0)" target="_blank">联系我们</a>
                </div>
                <div class="foot-phone">
                    <img src="/easier/img/phone.png">
                </div>
                <div class="foot-copyright">
                    <span style=" padding-right:15px; font-size:13px; line-height:24px; color:#666;">主办单位：北京市人民政府办公厅</span>
                    <span style=" padding-right:15px; font-size:13px; line-height:24px; color:#666;">备案：京ICP备123456789号-2</span>
                    <span style=" padding-right:15px; font-size:13px; line-height:24px; color:#666;">
		 		            <a href="javascript:void(0)" style="display:inline-block;text-decoration:none;line-height:24px;">
                                <img src="/easier/img/batb.png" style="float:left;">
                                <span style="font-size:13px;margin: 0px 0px 0px 5px;color:#666;">冀公网安备 12346579887465号</span>
                            </a>
		 	            </span>
                    <br>
                    <span style=" font-size:13px; line-height:24px; color:#666;">中文域名：北京朝阳.政务</span>
                    <span style=" font-size:13px; line-height:24px; color:#666;">建议使用1366*768分辨率/IE9.0或以上浏览器访问达到最佳效果</span>
                    <div class="foot-political"><a href="javascript:void(0)" target="_blank"><img src="/easier/img/political-logo.png" width="50" height="62"></a></div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<!-- 全局js -->
<script src="/hadmin/js/jquery.min.js?v=2.1.4"></script>
<script src="/hadmin/js/bootstrap.min.js?v=3.3.6"></script>
<script src="/plugins/bower_components/cookie/jquery.cookie.min.js"></script>
<!-- 自定义js -->
<script src="/hadmin/js/content.js?v=1.0.0"></script>
<!--twbsPagination-->
<script type="text/javascript" src="/plugins/bower_components/twbsPagination/jquery.twbsPagination.min.js"></script>
<!-- Sweet alert -->
<script src="/hadmin/js/plugins/sweetalert/sweetalert.min.js"></script>

<script src="/public/js/public.js"></script>
<script src="/easier/js/model.js"></script>
<script src="/easier/js/user.js"></script>
<script>
    $(function () {
        var pageType = getUrlParams()['type'];
        if(pageType == 'person'){
            $('.nav-item:eq('+ 1 +')').css('background-color','rgb(22, 118, 205)');
            $('.location-page-span').text('个人办事');
        }
        else if(pageType == 'enter'){
            $('.nav-item:eq('+ 2 +')').css('background-color','rgb(22, 118, 205)');
            $('.location-page-span').text('法人办事');
        }
        else{
            $('.nav-item:eq('+ 3 +')').css('background-color','rgb(22, 118, 205)');
            $('.location-page-span').text('行政审批');
        }


        $('.left-tit-sub').hover(function () {
            $(this).addClass('pointer').siblings().removeClass('pointer');
            var index = $(this).index();
            $('.left-sub').eq(index).show(50).siblings().hide(50);
        });

        $("#search").click(function () {
            initHtml(1,true);
        });
        $("#keyword").keydown(function(event){
            if (event.keyCode == 13) {
                $('#search').click();
                event.preventDefault();
            }
        });

        $('.left-sub').on('click','.depart-item',function () {
            if($(this).hasClass('pointer-depart')){
                $('.pointer-depart').removeClass('pointer-depart');
                initHtml(1,false);
            }
            else{
                $('.pointer-depart').removeClass('pointer-depart');
                $(this).addClass('pointer-depart');
                initHtml(1,false);
            }
        });

        initHtml(1,true);
        function initHtml(page,ispagination) {
            var title = $("#keyword").val();
            var index = $('.pointer-depart').attr('data-id');
            var type = "";
            if(index == undefined){
                type = '-1';
                index = '';
            }
            else{
                var location = $('.pointer-depart').parents(".left-sub").index();
                if(location == 0){
                    type = 'depart';
                }
                else if(location == 1){
                    type = 'type';
                }
            }
            Model.getProcess({
                'pageType':getUrlParams()['type'],
                'keyWords':title,
                'page':page,
                'pagesize':15,
                'type':type,
                'index':index
            },function(data) {
                if(data.code === CODE_SUCCESS){
                    appendHtml(data,page,ispagination);
                }else{
                    swal({
                        title: "出错了！",
                        text: '请重试'
                    });
                }
            },{},{});
        }
        
        function calHeatImg(heat) {
            if(heat>=0 && heat<5){
                return 1;
            }
            else if(heat>=5 && heat < 10){
                return 2;
            }
            else if(heat>=10 && heat < 15){
                return 3;
            }
            else if(heat>=15 && heat < 20){
                return 4;
            }
            else if(heat>=20){
                return 5;
            }
        }

        function appendHtml(data,page,ispagination) {
            var list = data.data;
            var length = list.length;
            var total = data.count;
            var pagesize = 10;
            var pageTotal =Math.ceil(total/pagesize);
            var html = '';
            for(var i=0;i<length;i++){
                var img = calHeatImg(list[i]['heatpoint'])+'.png';
                html += '<div class="process-list" data-id="'+ list[i]['pro_id'] +'">\
                    <div class="li-circle"></div>\
                        <span class="process-title" >'+ list[i]['pro_name'] +'</span>\
                    <div class="process-heat">\
                        <img src="/easier/img/'+ img +'" alt="">\
                    </div>\
                </div>';
            }
            $(".right-heat-list").html(html);
            if(ispagination){
                $("#processpage").html('<ul class="pagination"style="float:right"></ul>');
            }
            if(0!=pageTotal){
                $('#processpage .pagination').twbsPagination({
                    startPage:1,
                    currentPage:page,
                    totalPages: pageTotal,
                    visiblePages: 7,
                    first: '首页',
                    prev: '前一页',
                    next: '下一页',
                    last: '尾页',
                    lother: '共'+ pageTotal +'页',
                    onPageClick: function (event, page) {
                        initHtml(page,false);
                    }
                });
            }
        }
        $('.right-heat-list').on('click','.process-list',function () {
            var proId = $(this).attr('data-id');
            window.location.href = '/easier/process/proDetail?proId='+proId;
        });

    })
</script>

</html>